<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Stadion</title>

        <link rel="stylesheet" href="http://docs.stadion.io/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://docs.stadion.io/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://docs.stadion.io/css/highlight.tomorrow-night.css">
        <link rel="stylesheet" href="http://docs.stadion.io/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="http://docs.stadion.io/">
                Stadion
                <small class="hidden-xs hidden-sm">
                    The engine room for your digital stadium.
                </small>
            </a>

                            <a href="https://github.com/stadionHQ/Documentation">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                                                    <p class="text-muted">
                                Features
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/features/index.html">
                                            List of features
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Technical documentation
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/index.html">
                                            Overview
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/api.html">
                                            API
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/hosting.html">
                                            Hosting
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/deployments.html">
                                            CI & Deployments
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/services.html">
                                            Services
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/configuration.html">
                                            Configuration
                                        </a>
                                    </li>
                                                                    <li class="active">
                                        <a href="http://docs.stadion.io/datafeeds.html">
                                            Data feeds
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/cdn.html">
                                            CDN
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/responsive images.html">
                                            Responsive Images
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/multilanguage.html">
                                            Multi Language
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/video.html">
                                            Video
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/events.html">
                                            Events
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/generators.html">
                                            Generators
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Design Guidelines
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/1_homepage.html">
                                            Homepage
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/loginregister.html">
                                            Login & Register
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/2_news.html">
                                            News
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/3_news_article.html">
                                            News Article
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/4_fixtures.html">
                                            Fixtures
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/5_video.html">
                                            Video
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/6_video_detail.html">
                                            Video Detail
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/7_team_list.html">
                                            Squad List
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/8_player_profile.html">
                                            Player Profile
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/9_search_results.html">
                                            Search Results
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/11_match_preview.html">
                                            Match Preview
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/12_match_report.html">
                                            Match Report
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/13_match_day_live.html">
                                            Match Day Live
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/14_match_stats.html">
                                            Match Stats
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/all_reusable_elements.html">
                                            Reuseable Compnents
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/footer.html">
                                            Footer
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/design/header.html">
                                            Header
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Umbraco
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/umbraco/umbraco.html">
                                            Overview
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/umbraco/installation.html">
                                            Installation
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/umbraco/upgrades.html">
                                            Upgrades
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/umbraco/customwidgets.html">
                                            Custom Widgets
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Sitecore
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/sitecore/sitecore.html">
                                            Overview
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/sitecore/installation.html">
                                            Installation
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/sitecore/upgrades.html">
                                            Upgrades
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/sitecore/customwidgets.html">
                                            Custom Widgets
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Front End
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/index.html">
                                            Overview
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/build.html">
                                            Build
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/css.html">
                                            CSS
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/folder-structure.html">
                                            Folder Structure
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/api.html">
                                            API
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/modules/image.html">
                                            Image Module
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/grid-and-scaffolding.html">
                                            Grid
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/icons.html">
                                            Icons
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/javascript.html">
                                            Javascript
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/utilities.html">
                                            Javascript Utilities
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/realtime-updates.html">
                                            Realtime Updates
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://docs.stadion.io/frontend/server.html">
                                            Server
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                
                <section class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h1 id="data-feeds">Data Feeds</h1>
<p>As with any good sport based website, you are going to need to get your hands on some juicy data, to power things like the league table, player and match stats.
There are many data providers out there and out of the box we support the two most common: Opta and the Press Association.</p>
<p>We store all data in a SQL database, that is independent of which dataprovider you use. </p>
<p>We process the data as it comes in, normalise it and store it in a generic way for fast retrieval. Should you wish to use a different 3rd party data provider, you can do so.</p>
<h2 id="summary">Summary</h2>
<p>You post Opta files at the &quot;/feed&quot; endpoint.</p>
<p>This then uploads the file to S3 for permanent storage. Once uploaded, it posts a message in a message queue with a reference to the file on S3, so that a seperate web job (FootballDataProcessorWebJob.exe) can process the file. </p>
<p>FootballDataProcessorWebJob.exe read's messages from the queue and then processes the opta XML. It then stores it in the SQL database (SportsData)</p>
<p>Another message is then posted to a different queue, which is read by another webjob (Stadion.Football.DataPusherWebJob.exe).  It send's out real time messages using the IRealTimeClient implementation you are using.</p>
<h2 id="architecture-detail">Architecture Detail</h2>
<p>Data Feeds should be posed to the <code>FeedController</code>. The action is HandleFeed. By default the route is : /Feed</p>
<p>If you are passing in a feed that is not Opta, you need to pass in a querystring variable such as: ?provider=PressAssociation</p>
<p>When the feed is posted to the endpoint, we store the feed on a <code>IMediaStorageManager</code> implementation and push a message to a queue implementation (<code>IServiceBus</code>)  for processing by a webjob of some kind.</p>
<p>By Default, <code>IMediaStorageManager</code> is wired up to <code>S3MediaStorageManager</code>, which implements storing the files on S3. and the bucket name can be configured in the stadion.config file with property 'dataS3Bucket=&quot;newcastle-sportdata&quot;'</p>
<p>By Default, <code>IServiceBus</code> is wired up to <code>AzureServiceBus</code>, which implements an Azure Queue. You need to create two queues. &quot;footballdata&quot; and &quot;footballpushdata&quot;.</p>
<p>The S3 credentials are stored in web.config as per normal (in website and webjobs):</p>
<pre><code>    &lt;add key="AWSProfileName" value="production" /&gt;
    &lt;add key="AWSProfilesLocation" value="~/App_Data/awscredentials.txt" /&gt;
    &lt;add key="AWSAccessKey" value="*" /&gt;
    &lt;add key="AWSSecretKey" value="*" /&gt;
    &lt;add key="BaseAPIUrl" value="https://dev.xx.stadion.io/" /&gt;</code></pre>
<p>The name of the s3 bucket is defined in the Stadion.config  file (in website and webjobs).</p>
<pre><code>&lt;stadion&gt;
  &lt;generalSettings

       dataS3Bucket="clientname-sportdata"
    /&gt;</code></pre>
<p>The Queue details are stored in appsettings in the web.config of the site, with a name of <code>Microsoft.ServiceBus.ConnectionString</code>.</p>
<p>Example azure configuration:</p>
<pre><code> &lt;appSettings&gt;
        &lt;!-- Service Bus specific app setings for messaging connections --&gt;
      &lt;add key="StorageConnectionString" value="DefaultEndpointsProtocol=https;AccountName=xx;AccountKey=xxx" /&gt;
 &lt;/appSettings&gt;
</code></pre>
<p>Currently, the WebJobs are Azure WebJobs that listen to the queues and process data as they come in. To get the webjob's to run on azure, they must live inside the 'App_data\jobs\continuous' folder.</p>
<p>FootballDataProcessorWebJob - This processes the data posted to the 'footballdata' queue and then stores it in the database. It then pushes messages to the 'footballPushData' message queue, if any realtime updates need to be pushed out.</p>
<p>DataPusherWebJob - This sends out any realtime updates via your IRealtTimeClient ( Default implementation is Pubnub)</p>
<h2 id="webjob-appconfig">Webjob app.config</h2>
<p>You also need to specify the domain of your host in appsettings, as we communicate with it via an api.</p>
<pre><code>      &lt;add key="BaseAPIUrl" value="https://dev.xx.stadion.io/" /&gt;</code></pre>
                </section>

            </div>
        </main>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
